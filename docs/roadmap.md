# Roadmap: Backend Development

Этот план составлен на основе `manifest.md` и фокусируется на разработке серверной части приложения.

## Фаза 1: Инициализация и Инфраструктура
**Цель:** Подготовить фундамент для разработки.

- [x] **Инициализация проекта**
  - [x] Настроить Node.js и Express.js
  - [x] Настроить TypeScript
  - [x] Настроить ESLint и Prettier
- [x] **База данных**
  - [x] Поднять PostgreSQL
  - [x] Инициализировать Prisma ORM
  - [x] Настроить подключение к БД
- [x] **Конфигурация**
  - [x] Настроить переменные окружения (`.env`)
  - [x] Настроить логгер (например, winston или pino)
  - [x] Настроить CORS и Helmet для базовой безопасности

## Фаза 2: Аутентификация и Пользователи (MVP)
**Цель:** Реализовать управление доступом.

- [x] **Модели данных (Prisma)**
  - [x] Создать модель `User`
- [x] **API Аутентификации**
  - [x] Регистрация (`POST /api/auth/register`)
  - [x] Логин (`POST /api/auth/login`)
  - [x] Logout (если используются куки)
  - [x] Обновление токена (`POST /api/auth/refresh`)
  - [x] Middleware для проверки JWT
- [x] **Безопасность**
  - [x] Хеширование паролей (bcrypt)
  - [x] Валидация входных данных (Zod/Joi)

## Фаза 3: Управление Ресторанами (Core MVP)
**Цель:** Реализовать CRUD для ресторанов со всеми полями Google Business Profile.

- [x] **Модели данных (Prisma)**
  - [x] Создать модель `Restaurant` (со всеми полями: контакты, часы работы, атрибуты и т.д.)
  - [x] Настроить связи `User` -> `Restaurant`
- [x] **API Ресторанов**
  - [x] Создание ресторана (`POST /api/restaurants`)
  - [x] Получение списка ресторанов пользователя (`GET /api/restaurants`)
  - [x] Получение деталей ресторана (`GET /api/restaurants/:id`)
  - [x] Обновление ресторана (`PATCH /api/restaurants/:id`)
  - [x] Удаление ресторана (`DELETE /api/restaurants/:id`)
  - [x] Публикация/Снятие с публикации (`PATCH /api/restaurants/:id/publish` и `/unpublish`)
- [x] **Валидация**
  - [x] Строгая валидация JSON полей (часы работы, атрибуты)
- [x] **Swagger документация**
  - [x] Полная документация всех endpoints с примерами
  - [x] Enum для priceRange и других ограниченных значений


## Фаза 4: Работа с Медиа
**Цель:** Загрузка и хранение изображений.

- [x] **Инфраструктура**
  - [x] Выбрать провайдер (Cloudflare R2)
  - [x] Настроить Multer (или аналог) для обработки загрузок
- [x] **API Загрузки**
  - [x] Загрузка одного изображения (`POST /api/upload/image`)
  - [x] Массовая загрузка (`POST /api/upload/images`)
  - [x] Удаление изображения
- [x] **Обработка**
  - [x] Валидация типов файлов (только изображения)
  - [x] Ограничение размера

## Фаза 5: Публичный API
**Цель:** Отдача данных для публичных страниц ресторанов.

- [x] **API**
  - [ ] Получение списка опубликованных ресторанов (`GET /api/public/restaurants`)
  - [x] Получение ресторана по slug (`GET /api/public/restaurants/:slug`)
- [x] **Оптимизация**
  - [x] Выборка только публичных полей
  - [x] Оптимизация запросов к БД

## Фаза 6: Подготовка к Деплою
**Цель:** Вывод в продакшн.

- [ ] **Окружение**
  - [ ] Настройка переменных для Production
- [ ] **База данных**
  - [ ] Миграции для Production БД
- [ ] **Тестирование**
  - [ ] Ручное тестирование всех эндпоинтов
  - [ ] (Опционально) Написание тестов (Jest/Supertest)

---
**Следующие шаги:**
1. Начать с Фазы 1: Инициализация проекта.
2. Создать репозиторий и первый коммит.
